# 📦 運用設計書（Operations Plan）

<!--
このドキュメントは、アプリケーションの運用方針・体制・ルールについて整理するものです。
初学者チームでも迷わず運用できるよう、必要に応じて補足コメントを入れています。
-->

---

## 1. バージョン管理

| 項目         | 内容                                                                          |
| ------------ | ----------------------------------------------------------------------------- |
| ブランチ運用 | `main / develop / feature/xxx` による Git 運用を採用                          |
| 命名規則     | [Conventional Commits](https://www.conventionalcommits.org/ja/v1.0.0/) に準拠 |
| Git フック   | コミット前に Lint/整形実行（ESLint / Prettier / ruff / black）                |

---

## 2. デプロイ方針

| 項目           | 内容                                                                    |
| -------------- | ----------------------------------------------------------------------- |
| フロントエンド | Vercel に自動デプロイ（main マージ時）                                  |
| バックエンド   | Docker ベースで開発し、Render / Railway / Fly.io 等での本番環境を検討中 |
| CI/CD          | GitHub Actions にて Lint / Test / Build を PR 時に自動実行              |

---

## 3. ログ・監視

| 項目             | 内容                                                                               |
| ---------------- | ---------------------------------------------------------------------------------- |
| ログ出力         | FastAPI で API エラーをログに記録（logger モジュール使用）                         |
| エラーログの活用 | `.logs/error.log` にファイル出力、または将来的にクラウドログ導入検討（例：Sentry） |
| 監視ツール       | 必要に応じて導入（例：Sentry / LogRocket）                                         |

---

## 4. アカウント・権限管理

| 項目         | 内容                                                             |
| ------------ | ---------------------------------------------------------------- |
| 管理者権限   | Firebase Authentication（Google ログイン）で保護者ユーザーを認証 |
| 一般ユーザー | 子どもユーザーはログイン不要／保護者が管理（予定）               |
| 保護機能     | Next.js の App Router による認可ガードで `/admin` などを制限     |

---

## 5. バックアップ・復旧

| 項目            | 内容                                                                        |
| --------------- | --------------------------------------------------------------------------- |
| DB バックアップ | PostgreSQL のスナップショット／自動バックアップ機能（Railway 等）を利用想定 |
| 復旧手順        | DB コンテナのバックアップからリストア、または CSV インポートでの復元対応    |
| ファイル保存    | 録音ファイルは保存しない。Whisper API による文字起こしテキストのみ保存      |

---

## 6. サポート体制・問い合わせ

| 項目         | 内容                                                                   |
| ------------ | ---------------------------------------------------------------------- |
| 想定ユーザー | 保護者（主に母親）・子ども（小学生低学年）                             |
| サポート手段 | お問い合わせフォーム（実装予定）／開発段階では Slack・Notion で管理    |
| 対応ルール   | エラー・不具合は GitHub Issue に起票。開発メンバーで担当を割り振り対応 |

---

## 7. 運用スケジュール
